"0","knitr::opts_chunk$set(echo = TRUE)"
"0","library(tidyverse)"
"2","Registered S3 methods overwritten by 'dbplyr':
  method         from
  print.tbl_lazy     
  print.tbl_sql      
"
"2","[37m-- [1mAttaching packages[22m ----------------------------------------------------------------------------------------------------------------------------- tidyverse 1.3.1 --[39m
"
"2","[37m[32mv[37m [34mggplot2[37m 3.3.5     [32mv[37m [34mpurrr  [37m 0.3.4
[32mv[37m [34mtibble [37m 3.1.4     [32mv[37m [34mdplyr  [37m 1.0.7
[32mv[37m [34mtidyr  [37m 1.1.3     [32mv[37m [34mstringr[37m 1.4.0
[32mv[37m [34mreadr  [37m 2.0.1     [32mv[37m [34mforcats[37m 0.5.1[39m
"
"2","[37m-- [1mConflicts[22m -------------------------------------------------------------------------------------------------------------------------------- tidyverse_conflicts() --
[31mx[37m [34mdplyr[37m::[32mfilter()[37m masks [34mstats[37m::filter()
[31mx[37m [34mdplyr[37m::[32mlag()[37m    masks [34mstats[37m::lag()[39m
"
"0","library(shiny)"
"0","library(data.table)"
"2","Registered S3 method overwritten by 'data.table':
  method           from
  print.data.table     
"
"2","data.table 1.14.0 using 2 threads (see ?getDTthreads).  Latest news: r-datatable.com
"
"2","
Attaching package: â€˜data.tableâ€™

"
"2","The following objects are masked from â€˜package:dplyrâ€™:

    between, first, last

"
"2","The following object is masked from â€˜package:purrrâ€™:

    transpose

"
"0","library(shinydashboard)"
"2","
Attaching package: â€˜shinydashboardâ€™

"
"2","The following object is masked from â€˜package:graphicsâ€™:

    box

"
"0","library(shinyjs)"
"2","Use suppressPackageStartupMessages() to eliminate package startup messages.
"
"2","
Attaching package: â€˜shinyjsâ€™

"
"2","The following object is masked from â€˜package:shinyâ€™:

    runExample

"
"2","The following objects are masked from â€˜package:methodsâ€™:

    removeClass, show

"
"0","library(shinyBS)"
"0","library(shinycssloaders)"
"0","library(DT)"
"2","
Attaching package: â€˜DTâ€™

"
"2","The following objects are masked from â€˜package:shinyâ€™:

    dataTableOutput, renderDataTable

"
"0","library(sf)"
"2","Linking to GEOS 3.9.1, GDAL 3.2.1, PROJ 7.2.1
"
"0","library(mapview)"
"0","library(tigris)"
"2","To enable 
caching of data, set `options(tigris_use_cache = TRUE)` in your R script or .Rprofile.
"
"0","library(leaflet)"
"0","library(fuzzyjoin)"
"2","
Attaching package: â€˜fuzzyjoinâ€™

"
"2","The following object is masked from â€˜package:tigrisâ€™:

    geo_join

"
"0","library(maps)"
"2","
Attaching package: â€˜mapsâ€™

"
"2","The following object is masked from â€˜package:purrrâ€™:

    map

"
"0","library(stringr)"
"0","library(ggpubr)"
"0","theme_set(theme_pubr())"
"0",""
"0","data(county.fips)"
"0","hh <-fread(""C:\\Users\\reid.haefer\\OneDrive - Resource Systems Group, Inc\\Documents\\projects\\ODOT\\Household_Common.csv"")"
"2","|--------------------------------------------------|
|"
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","="
"2","|
"
"0","bzone_vars<-read_csv(""C:\\Users\\reid.haefer\\OneDrive - Resource Systems Group, Inc\\Documents\\projects\\ODOT\\ODOT_equity\\bzone_SLD_vars.csv"")"
"1","[1m[1mRows: [1m[22m[34m[34m4887[34m[39m [1m[1mColumns: [1m[22m[34m[34m15[34m[39m
"
"1","[36m--[39m [1m[1mColumn specification[1m[22m [36m----------------------------------------------------------------------------------------------------------------------------------------------[39m
[1mDelimiter:[22m "",""
[31mchr[39m  (5): bzone, azone, atype, dev_type, loc_type
[32mdbl[39m (10): mixed, D1B, D1C, D1D, D2A_EPHHM, D2A_JPHH, D2A_WRKEMP, D3bpo4, D4C, D5
"
"1","
[36mi[39m Use [38;5;251m[48;5;235m[38;5;251m[48;5;235m`spec()`[48;5;235m[38;5;251m[49m[39m to retrieve the full column specification for this data.
[36mi[39m Specify the column types or set [38;5;251m[48;5;235m[38;5;251m[48;5;235m`show_col_types = FALSE`[48;5;235m[38;5;251m[49m[39m to quiet this message.
"
"0","area_type_gab_bg <-st_read(""C://Users//reid.haefer//OneDrive - Resource Systems Group, Inc//Documents//projects//general//OR_AreaTypes"",""OR_AreaType"") %>%"
"0","  st_transform(crs=4326)"
"1","Reading layer `"
"1","OR_AreaType"
"1","' from data source "
"1","`"
"1","C:\Users\reid.haefer\OneDrive - Resource Systems Group, Inc\Documents\projects\general\OR_AreaTypes"
"1","' "
"1","using driver `"
"1","ESRI Shapefile"
"1","'"
"1","
"
"1","Simple feature collection with 2634 features and 14 fields"
"1","
"
"1","Geometry type: MULTIPOLYGON
"
"1","Dimension:     XY
"
"1","Bounding box:  "
"1","xmin: -124.7035 ymin: 41.99179 xmax: -116.4633 ymax: 46.2991"
"1","
"
"1","Geodetic CRS:  NAD83
"
"0","eq_high <- st_read(dsn=""C:\\Users\\reid.haefer\\Resource Systems Group, Inc\\Projects - Documents\\OR\\21068-ODOT_OHP\\GIS\\Equity"",""High_State_Equity"") %>%"
"0","  st_transform(crs=4326) %>%"
"0","  mutate(eq_cat=""high"")"
"1","Reading layer `"
"1","High_State_Equity"
"1","' from data source "
"1","`"
"1","C:\Users\reid.haefer\Resource Systems Group, Inc\Projects - Documents\OR\21068-ODOT_OHP\GIS\Equity"
"1","' "
"1","using driver `"
"1","ESRI Shapefile"
"1","'"
"1","
"
"1","Simple feature collection with 327 features and 37 fields"
"1","
"
"1","Geometry type: POLYGON
"
"1","Dimension:     XY
"
"1","Bounding box:  "
"1","xmin: -124.4483 ymin: 41.99509 xmax: -116.9414 ymax: 46.00154"
"1","
"
"1","Geodetic CRS:  NAD83
"
"0","eq_low <- st_read(dsn=""C:\\Users\\reid.haefer\\Resource Systems Group, Inc\\Projects - Documents\\OR\\21068-ODOT_OHP\\GIS\\Equity"",""Low_State_Equity2"") %>%"
"0","  st_transform(crs=4326)%>%"
"0","  mutate(eq_cat=""low"")"
"1","Reading layer `"
"1","Low_State_Equity2"
"1","' from data source "
"1","`"
"1","C:\Users\reid.haefer\Resource Systems Group, Inc\Projects - Documents\OR\21068-ODOT_OHP\GIS\Equity"
"1","' "
"1","using driver `"
"1","ESRI Shapefile"
"1","'"
"1","
"
"1","Simple feature collection with 603 features and 37 fields"
"1","
"
"1","Geometry type: POLYGON
"
"1","Dimension:     XY
"
"1","Bounding box:  "
"1","xmin: -124.2985 ymin: 41.997 xmax: -116.8941 ymax: 46.10076"
"1","
"
"1","Geodetic CRS:  NAD83
"
"0","eq_low_med <- st_read(dsn=""C:\\Users\\reid.haefer\\Resource Systems Group, Inc\\Projects - Documents\\OR\\21068-ODOT_OHP\\GIS\\Equity"",""LowMed_State_Equity"") %>%"
"0","  st_transform(crs=4326)%>%"
"0","  mutate(eq_cat=""low_med"")"
"1","Reading layer `"
"1","LowMed_State_Equity"
"1","' from data source "
"1","`"
"1","C:\Users\reid.haefer\Resource Systems Group, Inc\Projects - Documents\OR\21068-ODOT_OHP\GIS\Equity"
"1","' "
"1","using driver `"
"1","ESRI Shapefile"
"1","'"
"1","
"
"1","Simple feature collection with 894 features and 37 fields"
"1","
"
"1","Geometry type: MULTIPOLYGON
"
"1","Dimension:     XY
"
"1","Bounding box:  "
"1","xmin: -124.4389 ymin: 41.99259 xmax: -116.4633 ymax: 46.2991"
"1","
"
"1","Geodetic CRS:  NAD83
"
"0","eq_med_high <- st_read(dsn=""C:\\Users\\reid.haefer\\Resource Systems Group, Inc\\Projects - Documents\\OR\\21068-ODOT_OHP\\GIS\\Equity"",""MedHigh_State_Equity"") %>%"
"0","  st_transform(crs=4326)%>%"
"0","  mutate(eq_cat=""med_high"")"
"1","Reading layer `"
"1","MedHigh_State_Equity"
"1","' from data source "
"1","`"
"1","C:\Users\reid.haefer\Resource Systems Group, Inc\Projects - Documents\OR\21068-ODOT_OHP\GIS\Equity"
"1","' "
"1","using driver `"
"1","ESRI Shapefile"
"1","'"
"1","
"
"1","Simple feature collection with 801 features and 37 fields"
"1","
"
"1","Geometry type: MULTIPOLYGON
"
"1","Dimension:     XY
"
"1","Bounding box:  "
"1","xmin: -124.6195 ymin: 41.99208 xmax: -116.7837 ymax: 46.27101"
"1","
"
"1","Geodetic CRS:  NAD83
"
"0","equity<-bind_rows(eq_high, eq_low, eq_low_med, eq_med_high)"
"0",""
"0","smart_bg<-st_read(dsn=""C:/Users/reid.haefer/OneDrive - Resource Systems Group, Inc/Documents/projects/general/SmartLocationDatabaseV3/SmartLocationDatabase.gdb"",""EPA_SLD_Database_V3"") %>%"
"0","  st_transform(crs=4326) %>% filter(STATEFP == ""41"")"
"1","Reading layer `"
"1","EPA_SLD_Database_V3"
"1","' from data source "
"1","
"
"1","  "
"1","`"
"1","C:\Users\reid.haefer\OneDrive - Resource Systems Group, Inc\Documents\projects\general\SmartLocationDatabaseV3\SmartLocationDatabase.gdb"
"1","' "
"1","using driver `"
"1","OpenFileGDB"
"1","'"
"1","
"
"1","Simple feature collection with 220739 features and 181 fields"
"1","
"
"1","Geometry type: MULTIPOLYGON
"
"1","Dimension:     XY
"
"1","Bounding box:  "
"1","xmin: -10434580 ymin: -83867.97 xmax: 3407868 ymax: 6755033"
"1","
"
"1","Projected CRS: USA_Contiguous_Albers_Equal_Area_Conic_USGS_version
"
"0","hhbzone<-hh %>% "
"0","  group_by(Bzone) %>% # summarise household data at the bzone"
"0","  summarise(Dvmt_mean=mean(Dvmt,na.rm=T),"
"0","            Dvmt_q1=quantile(Dvmt, 0.25),"
"0","            Dvmt_q2=quantile(Dvmt, 0.5),"
"0","            Dvmt_q3=quantile(Dvmt, 0.75),"
"0","            TransitTrips_mean=mean(TransitTrips, na.rm=T),"
"0","            TransitTrips_q1=quantile(TransitTrips, 0.25),"
"0","            TransitTrips_q2=quantile(TransitTrips, 0.5),"
"0","            TransitTrips_q3=quantile(TransitTrips, 0.75),"
"0","            BikeTrips_mean=mean(BikeTrips, na.rm=T),"
"0","            BikeTrips_q1=quantile(BikeTrips, 0.25),"
"0","            BikeTrips_q2=quantile(BikeTrips, 0.5),"
"0","            BikeTrips_q3=quantile(BikeTrips, 0.75),"
"0","            WalkTrips_mean=mean(WalkTrips,na.rm=T),"
"0","            WalkTrips_q1=quantile(WalkTrips, 0.25),"
"0","            WalkTrips_q2=quantile(WalkTrips, 0.5),"
"0","            WalkTrips_q3=quantile(WalkTrips, 0.75),"
"0","            OwnCost_mean=mean(OwnCost,na.rm=T),"
"0","            OwnCost_q1=quantile( OwnCost, 0.25),"
"0","            OwnCost_q2=quantile( OwnCost, 0.5),"
"0","            OwnCost_q3=quantile( OwnCost, 0.75),"
"0","            DailyCO2e_mean=mean(DailyCO2e,na.rm=T),"
"0","            DailyCO2e_q1=quantile( DailyCO2e, 0.25),"
"0","            DailyCO2e_q2=quantile(DailyCO2e, 0.5),"
"0","            DailyCO2e_q3=quantile( DailyCO2e, 0.75),"
"0","            households=n()) "
"0",""
"0","hh_a_type<-bzone_vars %>% # join hh summary to azone vars table, which contains the atype data"
"0","  select(bzone, azone, atype,D1B) %>%"
"0","  left_join(hhbzone, by=c(""bzone""=""Bzone"")) %>% "
"0","  mutate(atype=str_to_title(atype),"
"0","         id=paste(azone, atype, sep=""-"")) %>%"
"0","  group_by(id) %>%"
"0","  summarise(Dvmt_mean=mean(Dvmt_mean,na.rm=T),"
"0","            TransitTrips_mean=mean(TransitTrips_mean, na.rm=T),"
"0","            BikeTrips_mean=mean(BikeTrips_mean, na.rm=T),"
"0","            WalkTrips_mean=mean(WalkTrips_mean,na.rm=T),"
"0","            OwnCost_mean=mean(OwnCost_mean,na.rm=T),"
"0","            DailyCO2e_mean=mean(DailyCO2e_mean,na.rm=T),"
"0","            Dvmt_q1=mean(Dvmt_q1,na.rm=T),"
"0","            TransitTrips_q1=mean(TransitTrips_q1, na.rm=T),"
"0","            BikeTrips_q1=mean(BikeTrips_q1, na.rm=T),"
"0","            WalkTrips_q1=mean(WalkTrips_q1,na.rm=T),"
"0","            OwnCost_q1=mean(OwnCost_q1,na.rm=T),"
"0","            DailyCO2e_q1=mean(DailyCO2e_q1,na.rm=T),"
"0","            Dvmt_q2=mean(Dvmt_q2,na.rm=T),"
"0","            TransitTrips_q2=mean(TransitTrips_q2, na.rm=T),"
"0","            BikeTrips_q2=mean(BikeTrips_q2, na.rm=T),"
"0","            WalkTrips_q2=mean(WalkTrips_q2,na.rm=T),"
"0","            OwnCost_q2=mean(OwnCost_q2,na.rm=T),"
"0","            DailyCO2e_q2=mean(DailyCO2e_q2,na.rm=T),"
"0","            Dvmt_q3=mean(Dvmt_q3,na.rm=T),"
"0","            TransitTrips_q3=mean(TransitTrips_q3, na.rm=T),"
"0","            BikeTrips_q3=mean(BikeTrips_q3, na.rm=T),"
"0","            WalkTrips_q3=mean(WalkTrips_q3,na.rm=T),"
"0","            OwnCost_q3=mean(OwnCost_q3,na.rm=T),"
"0","            DailyCO2e_q3=mean(DailyCO2e_q3,na.rm=T),"
"0","            households=sum(households,na.rm=T))"
"0",""
"0",""
"0","hh_a_type_bg<-area_type_gab_bg %>% mutate(fips=paste0(STATEFP10,COUNTYFP10)) %>% select(fips, GEOID10, VEAreaType) %>%"
"0","  left_join(county.fips %>% mutate(fips=as.character(fips)), by=""fips"") %>%"
"0","           mutate(county=gsub("".*,"","""",polyname),"
"0","                  county=str_to_title(county),"
"0","                  id=paste(county, VEAreaType, sep=""-"")) %>%"
"0","  left_join(hh_a_type, by=""id"")"
"0",""
"0","hh_equity<-equity %>%"
"0","  left_join(hh_a_type_bg %>% data.frame(), by=c(""GEOID""=""GEOID10""))"
"0",""
"0","hh_equitydf<- hh_equity %>% data.frame()"
"0",""
"0","sum_mean<-hh_equitydf %>%"
"0","  #filter(Final != 0) %>% "
"0","  group_by(id,Dvmt_mean,TransitTrips_mean,WalkTrips_mean,OwnCost_mean,DailyCO2e_mean) %>%"
"0","  summarise(equity=weighted.mean(StateEquit, Total_Popu), "
"0","            Age_Over64=weighted.mean(Age_Over64, Total_Popu),"
"0","            PovertySta=weighted.mean(PovertySta, Total_Popu),"
"0","            NonWhite_o=weighted.mean(NonWhite_o, Total_Popu),"
"0","            Disability=weighted.mean(Disability, Total_Popu))"
"1","`summarise()` has grouped output by 'id', 'Dvmt_mean', 'TransitTrips_mean', 'WalkTrips_mean', 'OwnCost_mean'. You can override using the `.groups` argument.
"
"0","sum_q3<-hh_equitydf %>%"
"0","  #filter(Final != 0) %>% "
"0","  group_by(id,Dvmt_q3,TransitTrips_q3,WalkTrips_q3,OwnCost_q3,DailyCO2e_q3) %>%"
"0","  summarise(equity=mean(StateEquit), "
"0","            Age_Over64=weighted.mean(Age_Over64, Total_Popu),"
"0","            PovertySta=weighted.mean(PovertySta, Total_Popu),"
"0","            NonWhite_o=weighted.mean(NonWhite_o, Total_Popu),"
"0","            Disability=weighted.mean(Disability, Total_Popu))"
"1","`summarise()` has grouped output by 'id', 'Dvmt_q3', 'TransitTrips_q3', 'WalkTrips_q3', 'OwnCost_q3'. You can override using the `.groups` argument.
"
"0","equity_sld<-equity %>% select(GEOID,Age_Under1,Age_Over64,Limited_En,White_Alon,NonWhite_o,Total_Popu,Disability,PovertySta,No_Vehicle,OverCrowdi,TransDisIn,StateEquit,X2Equity,Final,eq_cat) %>%"
"0","  left_join("
"0","    smart_bg %>% data.frame() %>% select(GEOID10,D1B,D1C,D2A_EPHHM,D2A_JPHH,D2A_WRKEMP,D3BPO4,D4C,D1D), by=c(""GEOID""=""GEOID10"")"
"0","  ) "
"0",""
"0","eq_sld_df <- equity_sld %>% data.frame() %>% select(-geometry)"
"0",""
"0","sld_labels <- data.frame(var=c(""D4C"",""D1B"",""D1C"" ,""D2A_EPHH"",""D2A_JPHH"",""D3BPO4"",""D2A_WRKEMP"",""D1D""),"
"0","                         label=c(""Transit Frequency"",""Population Density"",""Employment Density"",""Employment and household entropy"",""Jobs Per Household"",""Ped Friendly Intersection Density"", ""Household Workers Per Job"",""Activity Density (employment + HUs)"" ))"
"0",""
"0","##"
"0","eq_sld_sum <- data.frame(Disability_q1=quantile(equity_sld$Disability, 0.25),"
"0","                         Disability_q2=quantile(equity_sld$Disability, 0.5),"
"0","                         Disability_q3=quantile(equity_sld$Disability, 0.75),"
"0","                         Age_Over64_q1=quantile(equity_sld$Age_Over64, 0.25),"
"0","                         Age_Over64_q2=quantile(equity_sld$Age_Over64, 0.5),"
"0","                         Age_Over64_q3=quantile(equity_sld$Age_Over64, 0.75),"
"0","                         PovertySta_q1=quantile(equity_sld$PovertySta, 0.25),"
"0","                         PovertySta_q2=quantile(equity_sld$PovertySta, 0.5),"
"0","                         PovertySta_q3=quantile(equity_sld$PovertySta, 0.75),"
"0","                         Limited_En_q1=quantile(equity_sld$Limited_En, 0.25),"
"0","                         Limited_En_q2=quantile(equity_sld$Limited_En, 0.5),"
"0","                         Limited_En_q3=quantile(equity_sld$Limited_En, 0.75),"
"0","                         D4C_q1=quantile(equity_sld$D4C, 0.25),"
"0","                         D4C_q2=quantile(equity_sld$D4C, 0.5),"
"0","                         D4C_q3=quantile(equity_sld$D4C, 0.75),"
"0","                         D3BPO4_q1=quantile(equity_sld$D3BPO4, 0.25),"
"0","                         D3BPO4_q2=quantile(equity_sld$D3BPO4, 0.5),"
"0","                         D3BPO4_q3=quantile(equity_sld$D3BPO4, 0.75),"
"0","                         D2A_JPHH_q1=quantile(equity_sld$D2A_JPHH, 0.25),"
"0","                         D2A_JPHH_q2=quantile(equity_sld$D2A_JPHH, 0.5),"
"0","                         D2A_JPHH_q3=quantile(equity_sld$D2A_JPHH, 0.75)) %>% "
"0","  pivot_longer(cols=everything()) %>%"
"0","  mutate(category=str_sub(name, end=-4))"
